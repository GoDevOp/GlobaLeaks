<div class="row">
  <div id="ConfigSidebarBox" class="col-md-3" data-ng-include="'views/admin/sidebar.html'"></div>
  <div class="col-md-9">
    <div id="HttpsSettings" data-ng-controller="AdminHTTPSConfigCtrl">
      <div>
        <h3 data-translate>HTTPS Dashboard</h3>
        <h3><span data-translate>Status</span>:
          <span data-ng-show="tls_config.enabled" class="label label-success" data-translate>Enabled</span>
          <span data-ng-hide="tls_config.enabled" class="label label-danger" data-translate>Disabled</span>
          <span data-ng-show="tls_config.running" class="label label-success" data-translate>Running</span>
          <span data-ng-show="!tls_config.running" class="label label-warning" data-translate>Not running</span>
        </h3>
        <h4><span data-translate>Resource locator</span>:
            <a target="_blank" rel="noreferrer noopener" href="{{ tls_config.https_url }}">{{ tls_config.https_url }}</a>
        </h4>
        <h4 data-translate>System message:</h4>
        <div data-ng-show="tls_config" class="alert alert-info"><b>{{ tls_config.status.timestamp | date:'dd-MM-yyyy HH:mm:ss' }} </b>{{ tls_config.status.msg }}</div>
      </div>
      <div>
        <h3 data-translate>Configuration</h3>

        <div class="panel panel-default hideable-div">
          <div data-ng-hide="!tls_config.enabled" class="disabling-div"></div>
          <div class="panel-body">
            <i class="glyphicon glyphicon-file" data-ng-class="iconClass(tls_config.files.priv_key)"></i>
            <b data-translate>Private key</b>
            <div class="pull-right">
              <span class="file-upload" data-ng-if="!tls_config.files.priv_key.set">
                <label for="certUpload" class="btn btn-xs btn-primary">
                  <input id="certUpload" type="file" file-change
                  handler="postFile(files, file_resources.priv_key)"  />
                  <span data-translate>Upload</span>
                </label>
              </span>
              <button class="btn btn-xs btn-success" data-ng-if="!tls_config.files.priv_key.set"
                  data-ng-click="gen_priv_key()">Generate</button>
              <span data-ng-if="tls_config.files.priv_key.set">
                <button class="btn btn-xs btn-danger"
                    data-ng-click="deleteFile(file_resources.priv_key)">Delete</button>
              </span>
            </div>
          </div>
        </div>

        <div class="panel panel-default hideable-div">
          <div data-ng-hide="tls_config.files.priv_key.set && !tls_config.files.cert.set && !tls_config.enabled" class="disabling-div"></div>
          <div class="panel-body">
            <i class="glyphicon glyphicon-file"></i>
            <b data-translate>Certificate signing request</b>
            <small>(.pem)</small>
            <div class="pull-right">
              <button class="btn btn-xs btn-success" data-ng-hide="csr_state.open" data-ng-click="csr_state.open = true">
                <span data-translate>Generate</span>
              </button>
              <button type="button" class="close" data-ng-show="csr_state.open" data-ng-click="csr_state.open = false" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div data-ng-show="csr_state.open">
               <hr />
               <div ng-include="'views/admin/https/csr_gen.html'"></div>
            </div>
          </div>
        </div>

        <div class="panel panel-default hideable-div">
            <div data-ng-hide="(tls_config.files.cert.set || tls_config.files.priv_key.set) && !tls_config.enabled" class="disabling-div"></div>
          <div class="panel-body">
            <i class="glyphicon glyphicon-file" data-ng-class="iconClass(tls_config.files.cert)"></i>
            <b data-translate>Certificate</b>
            <small>(.pem) <span data-translate>Valid until:</span> {{ tls_config.files.cert.expiration | date:'dd-MM-yyyy HH:MM' }}</small>
            <div class="pull-right">
              <span class="file-upload" data-ng-if="tls_config.files.priv_key.set && !tls_config.files.cert.set">
                <label for="certUpload" class="btn btn-xs btn-primary">
                  <input id="certUpload" type="file" file-change
                  handler="postFile(files, file_resources.cert)"  />
                  <span data-translate>Upload</span>
                </label>
              </span>
              <span data-ng-if="tls_config.files.cert.set">
                <button class="btn btn-xs btn-primary"
                    data-ng-click="downloadFile(file_resources.cert)">Download</button>
                <button class="btn btn-xs btn-danger"
                    data-ng-click="deleteFile(file_resources.cert)">Delete</button>
              </span>
            </div>
          </div>
        </div>

        <div class="panel panel-default hideable-div">
          <div data-ng-hide="(tls_config.files.chain.set || tls_config.files.priv_key.set) && !tls_config.enabled" class="disabling-div"></div>
          <div class="panel-body">
            <i class="glyphicon glyphicon-file" data-ng-class="iconClass(tls_config.files.chain)"></i>
            <b data-translate>Certificate chain</b>
            <small>(.pem) <span data-translate>Valid until:</span> {{ tls_config.files.chain.expiration | date:'dd-MM-yyyy HH:MM' }}</small>
            <div class="pull-right">
              <span class="file-upload" data-ng-if="tls_config.files.priv_key.set && !tls_config.files.chain.set">
                <label for="chainUpload" class="btn btn-xs btn-primary">
                  <input id="chainUpload" type="file" file-change
                  handler="postFile(files, file_resources.chain)" />
                  <span data-translate>Upload</span>
                </label>
              </span>
              <span data-ng-if="tls_config.files.chain.set">
                <button class="btn btn-xs btn-primary"
                     data-ng-click="downloadFile(file_resources.chain)">Download</button>
                <button class="btn btn-xs btn-danger"
                    data-ng-click="deleteFile(file_resources.chain)">Delete</button>
              </span>
            </div>
          </div>
        </div>

      </div>

      <button class="btn btn-md btn-primary" data-translate>Test</button>
      <button class="btn btn-md btn-success" data-ng-if="!tls_config.enabled"
          data-ng-click="toggleCfg()"
          data-translate>Enable</button>
      <button class="btn btn-md btn-danger" data-ng-if="tls_config.enabled"
          data-ng-click="toggleCfg()"
          data-translate>Disable</button>
      <button class="btn btn-md btn-danger"
          data-ng-click="deleteAll()"
          data-translate>Delete All</button>
    </div>
  </div>
</div>
